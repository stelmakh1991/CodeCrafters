{"version":3,"file":"commonHelpers2.js","sources":["../src/js/shoppingList.js"],"sourcesContent":["import axios from 'https://cdn.skypack.dev/axios';\n\nimport Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.css';\n\nimport { renderShoppingListFromLocalStorage } from './local-storage';\nimport { localStorageItems } from './local-storage';\nimport { renderBookFromLocalStorageWithoutFetch } from './local-storage';\nimport { shoppingList } from './local-storage';\n\n// const shoppingList = document.querySelector('.shopping-list');\nconst placeholder = document.querySelector('.shop-list-placeholder');\n// const localStorageItems = JSON.parse(localStorage.getItem('books')) || [];\nconst paginationContainer = document.querySelector('.tui-pagination');\n\nasync function getBooksAndAddToLocalStorage(array) {\n  const localStorageArray = [];\n\n  try {\n    // Use Promise.all to await all Axios requests concurrently\n    await Promise.all(\n      array.map(async id => {\n        const url = `https://books-backend.p.goit.global/books/${id}`;\n        const response = await axios.get(url);\n        localStorageArray.push(response.data); // Push entire book object to the array\n      })\n    );\n\n    // Convert the array to a string before storing it in local storage\n    localStorage.setItem('books', JSON.stringify(localStorageArray));\n  } catch (error) {\n    console.error('Error fetching books:', error);\n    // Optionally, you can handle the error here, e.g., display an error message to the user\n    iziToast.error({\n      title: 'Error',\n      message: `Oops! Something went wrong while fetching books. Please try again later or contact support if the issue persists.`,\n      position: 'topRight',\n    });\n  }\n}\n\nconst booksToFetch = [\n  '643282b1e85766588626a0dc',\n  '643282b1e85766588626a080',\n  '643282b1e85766588626a0b2',\n  '643282b1e85766588626a085',\n  '643282b1e85766588626a085',\n  '643282b1e85766588626a0dc',\n  '643282b1e85766588626a086',\n  '643282b1e85766588626a0dc',\n  '643282b1e85766588626a085',\n  '643282b1e85766588626a0b2',\n  '643282b1e85766588626a086',\n  '643282b1e85766588626a086',\n  '643282b1e85766588626a085',\n  '643282b1e85766588626a085',\n  '643282b1e85766588626a0dc',\n  '643282b1e85766588626a086',\n  '643282b1e85766588626a0dc',\n  '643282b1e85766588626a085',\n  '643282b1e85766588626a0b2',\n  '643282b1e85766588626a086',\n];\n\ngetBooksAndAddToLocalStorage(booksToFetch);\n\n// ===================== Get from local storage ========================================================================\n\n\n\n// ============================ Placeholder =======================================\n\nrenderShoppingListFromLocalStorage();\n\nfunction toggleVisibility() {\n    if (localStorageItems.length === 0) {\n        placeholder.style.display = 'block'; // Display placeholder if no items left\n    } else {\n        placeholder.style.display = 'none'; // Hide placeholder if items exist\n    }\n}\n\ntoggleVisibility();\n\n// =========================== Pagination ============================================\n\nconst pagination = new Pagination(paginationContainer, {\n  totalItems: localStorageItems.length, // Set the total number of items\n  itemsPerPage: getWindowWidth() <= 767 ? 4 : 3,\n  visiblePages: 3, // Set the number of visible pages\n  page: 1, // Set the initial page\n    template: {\n        page: '<a href=\"#\" class=\"tui-page-btn\">{{page}}</a>',\n        currentPage: '<strong class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\n        moveButton:\n             '<a href=\"#\" class=\"tui-page-btn tui-{{type}}\">' +\n                 '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n             '</a>',\n        disabledMoveButton:\n             '<span class=\"tui-page-btn tui-is-disabled tui-{{type}}\">' +\n                 '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n             '</span>',\n       moreButton:\n             '<a href=\"#\" class=\"tui-page-btn tui-{{type}}-is-ellip\">' +\n                 '<span class=\"tui-ico-ellip\">...</span>' +\n             '</a>'\n     }\n});\n\nfunction getWindowWidth() {\n  return window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n}\n\n// Handle page change event\npagination.on('afterMove', function (eventData) {\n  renderBooks(eventData.page); // Render books based on the current page\n});\n\nfunction renderBooks(page) {\n  shoppingList.innerHTML = ''; // Clear the shopping list\n  const startIndex = (page - 1) * pagination._options.itemsPerPage;\n  const endIndex = startIndex + pagination._options.itemsPerPage;\n  const booksToRender = localStorageItems.slice(startIndex, endIndex);\n\n  booksToRender.forEach(book => {\n    renderBookFromLocalStorageWithoutFetch(book);\n  });\n}\n\n// =================== Remove from shopping list and local storage =============================\n\n// Видалення елемента з Shopping List\nexport function onRemoveFromShoppingListAndLocalStorage(e) {\n  const target = e.target;\n\n  // Check if the clicked element is the button or PNG image\n  if (target.classList.contains('delete-btn-icon') || target.classList.contains('delete-btn')) {\n    const button = target.closest('.delete-btn');\n    const id = button.parentNode.dataset.id; // Get the ID from the parent element\n    const index = localStorageItems.findIndex(item => item._id === id);\n\n    if (index !== -1) {\n      localStorageItems.splice(index, 1);\n      localStorage.setItem('books', JSON.stringify(localStorageItems));\n      renderBooks(pagination.getCurrentPage()); // Render books for the current page\n      pagination.reset(localStorageItems.length); // Reset pagination with updated total items\n    }\n\n    button.parentNode.remove(); // Remove the parent element (li)\n    toggleVisibility();\n\n    if (localStorageItems.length === 0) {\n      localStorage.removeItem('books');\n      paginationContainer.style.display = 'none';\n    }\n  }\n}\n\nshoppingList.addEventListener('click', onRemoveFromShoppingListAndLocalStorage);\n\n// Initial rendering\nrenderBooks(1); // Render books for the first page"],"names":["placeholder","paginationContainer","getBooksAndAddToLocalStorage","array","localStorageArray","id","url","response","axios","error","booksToFetch","renderShoppingListFromLocalStorage","toggleVisibility","localStorageItems","pagination","Pagination","getWindowWidth","eventData","renderBooks","page","shoppingList","startIndex","endIndex","book","renderBookFromLocalStorageWithoutFetch","onRemoveFromShoppingListAndLocalStorage","e","target","button","index","item"],"mappings":"yKAWA,MAAMA,EAAc,SAAS,cAAc,wBAAwB,EAE7DC,EAAsB,SAAS,cAAc,iBAAiB,EAEpE,eAAeC,EAA6BC,EAAO,CACjD,MAAMC,EAAoB,CAAA,EAE1B,GAAI,CAEF,MAAM,QAAQ,IACZD,EAAM,IAAI,MAAME,GAAM,CACpB,MAAMC,EAAM,6CAA6CD,CAAE,GACrDE,EAAW,MAAMC,EAAM,IAAIF,CAAG,EACpCF,EAAkB,KAAKG,EAAS,IAAI,CAC5C,CAAO,CACP,EAGI,aAAa,QAAQ,QAAS,KAAK,UAAUH,CAAiB,CAAC,CAChE,OAAQK,EAAO,CACd,QAAQ,MAAM,wBAAyBA,CAAK,EAE5C,SAAS,MAAM,CACb,MAAO,QACP,QAAS,oHACT,SAAU,UAChB,CAAK,CACF,CACH,CAEA,MAAMC,EAAe,CACnB,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,0BACF,EAEAR,EAA6BQ,CAAY,EAQzCC,IAEA,SAASC,GAAmB,CACpBC,EAAkB,SAAW,EAC7Bb,EAAY,MAAM,QAAU,QAE5BA,EAAY,MAAM,QAAU,MAEpC,CAEAY,IAIA,MAAME,EAAa,IAAIC,EAAWd,EAAqB,CACrD,WAAYY,EAAkB,OAC9B,aAAcG,EAAc,GAAM,IAAM,EAAI,EAC5C,aAAc,EACd,KAAM,EACJ,SAAU,CACN,KAAM,gDACN,YAAa,iEACb,WACK,mGAGL,mBACK,gHAGN,WACM,mGAGP,CACN,CAAC,EAED,SAASA,GAAiB,CACxB,OAAO,OAAO,YAAc,SAAS,gBAAgB,aAAe,SAAS,KAAK,WACpF,CAGAF,EAAW,GAAG,YAAa,SAAUG,EAAW,CAC9CC,EAAYD,EAAU,IAAI,CAC5B,CAAC,EAED,SAASC,EAAYC,EAAM,CACzBC,EAAa,UAAY,GACzB,MAAMC,GAAcF,EAAO,GAAKL,EAAW,SAAS,aAC9CQ,EAAWD,EAAaP,EAAW,SAAS,aAC5BD,EAAkB,MAAMQ,EAAYC,CAAQ,EAEpD,QAAQC,GAAQ,CAC5BC,EAAuCD,CAAI,CAC/C,CAAG,CACH,CAKO,SAASE,EAAwCC,EAAG,CACzD,MAAMC,EAASD,EAAE,OAGjB,GAAIC,EAAO,UAAU,SAAS,iBAAiB,GAAKA,EAAO,UAAU,SAAS,YAAY,EAAG,CAC3F,MAAMC,EAASD,EAAO,QAAQ,aAAa,EACrCtB,EAAKuB,EAAO,WAAW,QAAQ,GAC/BC,EAAQhB,EAAkB,UAAUiB,GAAQA,EAAK,MAAQzB,CAAE,EAE7DwB,IAAU,KACZhB,EAAkB,OAAOgB,EAAO,CAAC,EACjC,aAAa,QAAQ,QAAS,KAAK,UAAUhB,CAAiB,CAAC,EAC/DK,EAAYJ,EAAW,eAAc,CAAE,EACvCA,EAAW,MAAMD,EAAkB,MAAM,GAG3Ce,EAAO,WAAW,SAClBhB,IAEIC,EAAkB,SAAW,IAC/B,aAAa,WAAW,OAAO,EAC/BZ,EAAoB,MAAM,QAAU,OAEvC,CACH,CAEAmB,EAAa,iBAAiB,QAASK,CAAuC,EAG9EP,EAAY,CAAC"}